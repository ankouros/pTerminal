<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <title>pTerminal</title>

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="color-scheme" content="dark" />

  <link rel="icon" href="__PTERMINAL_LOGO__" />

  <link rel="stylesheet" href="vendor/xterm.css" />
  <link rel="stylesheet" href="app.css" />
</head>

<body>
  <div id="app">
    <header id="navbar" role="banner">
      <div class="nav-left">
        <div id="nav-brand" aria-label="Application name">
          <img id="nav-logo" alt="" src="__PTERMINAL_LOGO__" />
          <span>pTerminal</span>
        </div>

        <select id="team-select" title="Select team" aria-label="Select team"></select>
        <select id="network-select" title="Select network" aria-label="Select network"></select>

        <button id="btn-add-network" class="btn small" title="Add network">
          + Network
        </button>
        <button id="btn-add-host" class="btn small" title="Add host">
          + Host
        </button>
      </div>

      <div class="nav-right">
        <button id="btn-export" class="btn small" title="Export configuration">
          Export
        </button>
        <button id="btn-import" class="btn small secondary" title="Import configuration (.json)">
          Import
        </button>
        <button id="btn-teams" class="btn small secondary" title="Teams">
          Teams
        </button>
        <button id="btn-about" class="btn small secondary" title="About pTerminal">
          About
        </button>
        <div id="update-widget" class="update-widget hidden">
          <span id="update-text" class="update-text"></span>
          <button id="btn-check-updates" class="btn small secondary update-btn" title="Check for updates">
            Check updates
          </button>
          <button id="btn-install-update" class="btn small primary update-btn hidden" title="Download and install update">
            Install update
          </button>
        </div>
      </div>
    </header>

    <div id="content">
      <aside id="sidebar" role="navigation" aria-label="Hosts">
        <div id="sidebar-title">Hosts</div>
        <div id="hosts" role="list"></div>
        <div id="scripts-title">
          <span>Scripts</span>
          <button id="btn-add-script" class="btn small secondary" title="Add script">
            + Script
          </button>
        </div>
        <div id="scripts" role="list"></div>
      </aside>

      <main id="main" role="main">
        <header id="topbar">
          <div class="topbar-left">
            <div id="title" aria-live="polite">Select a host</div>
          </div>

          <div class="topbar-right">
            <div class="term-actions" aria-label="Terminal actions">
              <input id="term-search" class="term-search" type="text" placeholder="Search…" spellcheck="false"
                autocomplete="off" />
              <button id="btn-find-prev" class="btn small secondary term-btn" title="Find previous">Prev</button>
              <button id="btn-find-next" class="btn small secondary term-btn" title="Find next">Next</button>
              <button id="btn-copy" class="btn small secondary term-btn" title="Copy selection (Ctrl+Shift+C)">Copy</button>
              <button id="btn-paste" class="btn small secondary term-btn" title="Paste (Ctrl+Shift+V)">Paste</button>
              <button id="btn-clear" class="btn small secondary term-btn" title="Clear terminal">Clear</button>
              <button id="btn-disconnect" class="btn small term-btn" style="color: #ff6b7d; border-color: rgba(255, 107, 125, 0.4)"
                title="Disconnect (stop reconnect attempts)">
                Disconnect
              </button>
            </div>

            <div id="status" class="status-disconnected" title="Connection status" aria-live="polite">
              <div class="status-dot" aria-hidden="true"></div>
              <span class="status-text">disconnected</span>
              <span class="status-attempts"></span>
            </div>
          </div>
        </header>

        <div id="main-tabs" class="tabs hidden" role="tablist" aria-label="Main tabs">
          <button id="tab-terminal" class="tab active" role="tab" aria-selected="true">Terminal</button>
          <button id="tab-files" class="tab" role="tab" aria-selected="false">Files</button>
        </div>

        <div id="terminal-tabs" class="terminal-tabs hidden" role="tablist" aria-label="Terminal tabs">
          <div id="terminal-tab-list" class="terminal-tab-list"></div>
          <button id="btn-new-term-tab" class="btn small secondary" title="New terminal tab">+ Tab</button>
        </div>

        <div id="terminal-container" role="region" aria-label="Terminal"></div>
        <div id="files-container" class="hidden" role="region" aria-label="Files"></div>
      </main>
    </div>
  </div>

  <!-- Host context menu -->
  <div id="host-menu" class="context-menu hidden" role="menu" aria-label="Host menu">
    <button id="host-menu-connect" class="context-item" role="menuitem">Connect</button>
    <button id="host-menu-edit" class="context-item" role="menuitem">Edit</button>
    <button id="host-menu-duplicate" class="context-item" role="menuitem">Duplicate</button>
    <button id="host-menu-delete" class="context-item danger" role="menuitem">Delete</button>
  </div>

  <!-- Files (SFTP) context menu -->
  <div id="file-menu" class="context-menu hidden" role="menu" aria-label="File menu">
    <button id="file-menu-open" class="context-item" role="menuitem">Open</button>
    <button id="file-menu-edit" class="context-item" role="menuitem">Edit</button>
    <button id="file-menu-download" class="context-item" role="menuitem">Download</button>
    <button id="file-menu-upload" class="context-item" role="menuitem">Upload…</button>
    <button id="file-menu-mkdir" class="context-item" role="menuitem">New Folder…</button>
    <button id="file-menu-rename" class="context-item" role="menuitem">Rename…</button>
    <button id="file-menu-delete" class="context-item danger" role="menuitem">Delete</button>
    <button id="file-menu-copy-path" class="context-item" role="menuitem">Copy Path</button>
    <button id="file-menu-refresh" class="context-item" role="menuitem">Refresh</button>
  </div>

  <!-- File editor modal -->
  <div id="file-edit-modal" class="modal hidden" role="dialog" aria-modal="true" aria-labelledby="file-edit-title">
    <div class="modal-card file-edit-card">
      <div class="modal-title" id="file-edit-title">Edit file</div>
      <div class="modal-body">
        <div class="file-edit-meta">
          <div class="label">Path</div>
          <div class="value mono" id="file-edit-path"></div>
        </div>
        <textarea id="file-edit-text" class="file-edit-text" spellcheck="false"></textarea>
        <div class="help">Tip: Ctrl+S to save. Large/binary files are not supported.</div>
      </div>

      <div class="modal-actions">
        <button id="file-edit-cancel" class="btn secondary">Cancel</button>
        <button id="file-edit-save" class="btn primary">Save</button>
      </div>
    </div>
  </div>

  <!-- About modal -->
  <div id="about-modal" class="modal hidden" role="dialog" aria-modal="true" aria-labelledby="about-title">
    <div class="modal-card about-card">
      <div class="modal-title" id="about-title">About pTerminal</div>

      <div class="modal-body">
        <div class="about-header">
          <img id="about-logo" alt="" src="__PTERMINAL_LOGO__" />
          <div>
            <div class="about-name">pTerminal</div>
            <div class="about-sub">
              Persistent multi-node SSH terminal manager (Go + WebView + xterm.js)
            </div>
          </div>
        </div>

        <div class="about-full" id="about-full">Inspecting build info…</div>

        <div class="about-grid about-version-grid">
          <div class="label">Version</div>
          <div class="value" id="about-version">—</div>

          <div class="label">Commit</div>
          <div class="value mono" id="about-commit">—</div>

          <div class="label">Build time</div>
          <div class="value" id="about-build-time">—</div>
        </div>

        <div class="about-section">
          <div class="about-section-title">Release info</div>
          <div class="about-grid about-release-grid">
            <div class="label">Latest release</div>
            <div class="value" id="about-release-tag">—</div>

            <div class="label">Status</div>
            <div class="value" id="about-update-status">Loading status…</div>

            <div class="label">Release notes</div>
            <div class="value about-release-notes" id="about-release-notes">
              Release notes unavailable.
            </div>
          </div>
          <div class="about-release-links">
            <a id="about-release-link" class="about-release-link hidden" href="#" target="_blank" rel="noopener">
              View release
            </a>
            <button id="btn-about-check-updates" type="button" class="btn small secondary">
              Check updates
            </button>
            <button id="btn-about-install-update" type="button" class="btn small primary hidden">
              Install update
            </button>
          </div>
        </div>

        <div class="about-grid about-dev-grid">
          <div class="label">Developer</div>
          <div class="value">
            <span class="mono" id="about-email">ankouros30@gmail.com</span>
            <button id="about-copy-email" class="btn small secondary term-btn" style="margin-left: 8px">Copy</button>
          </div>

          <div class="label">GitHub</div>
          <div class="value">
            <span class="mono" id="about-github">https://github.com/ankouros/pterminal</span>
            <button id="about-copy-github" class="btn small secondary term-btn" style="margin-left: 8px">Copy</button>
          </div>
        </div>
      </div>

      <div class="modal-actions">
        <button id="about-close" class="btn secondary">Close</button>
      </div>
    </div>
  </div>

  <!-- Teams modal -->
  <div id="teams-modal" class="modal hidden" role="dialog" aria-modal="true" aria-labelledby="teams-title">
    <div class="modal-card teams-card">
      <div class="modal-title" id="teams-title">Teams</div>

      <div class="modal-body teams-body">
        <div class="teams-profile">
          <div class="label" id="profile-label">Your profile</div>
          <div id="profile-display" class="teams-profile-display hidden">
            <div class="profile-row">
              <div class="profile-info">
                <div class="profile-line"><span class="profile-label">Name:</span> <span id="profile-name-text"></span></div>
                <div class="profile-line"><span class="profile-label">Email:</span> <span id="profile-email-text"></span></div>
              </div>
              <button id="profile-edit" class="btn small secondary">Edit</button>
            </div>
          </div>
          <div id="profile-form" class="teams-profile-row">
            <input id="profile-name" type="text" placeholder="Name" />
            <input id="profile-email" type="email" placeholder="Email" />
            <button id="profile-save" class="btn small primary">Save</button>
          </div>
        </div>

        <div class="teams-grid">
          <div class="teams-list">
            <div class="teams-list-header">
              <div class="label">Teams</div>
              <button id="btn-team-create" class="btn small secondary">+ Team</button>
            </div>
            <div id="teams-list" role="list"></div>
          </div>

          <div class="team-detail">
            <div class="form-group">
              <label>Name</label>
              <input id="team-name" type="text" />
              <div id="team-name-display" class="team-name-display hidden"></div>
            </div>
            <div class="form-group">
              <label>Team ID</label>
              <div id="team-id" class="value mono"></div>
            </div>
            <div class="form-group">
              <label>Repo Path</label>
              <div class="team-repo-row">
                <div id="team-repo-path" class="value mono"></div>
                <button id="team-copy-path" class="btn small secondary">Copy</button>
              </div>
            </div>
            <div class="form-group" id="team-request-row">
              <label>Access</label>
              <div id="team-request-status" class="team-request-status"></div>
              <button id="team-request-access" class="btn small secondary">Request access</button>
            </div>
            <div class="form-group" id="team-requests-row">
              <label>Pending requests</label>
              <div id="team-requests"></div>
            </div>
            <div class="form-group">
              <label>Members</label>
              <div id="team-members"></div>
              <div class="team-add-member">
                <input id="team-member-name" type="text" placeholder="Name" />
                <input id="team-member-email" type="email" placeholder="Email" />
                <button id="team-add-member" class="btn small">Add</button>
              </div>
            </div>
            <div class="modal-actions teams-actions">
              <button id="team-leave" class="btn secondary danger">Leave</button>
              <button id="team-delete" class="btn secondary">Delete</button>
              <button id="team-save" class="btn primary">Save</button>
            </div>
          </div>
        </div>
      </div>

      <div class="modal-actions">
        <button id="teams-close" class="btn secondary">Close</button>
      </div>
    </div>
  </div>

  <div id="trust-modal" class="modal hidden" role="dialog" aria-modal="true" aria-labelledby="trust-title">
    <div class="modal-card">
      <div id="trust-title" class="modal-title">Trust SSH Host Key?</div>

      <div class="modal-body">
        <div class="modal-row">
          <div class="label">Host</div>
          <div id="trust-host" class="value"></div>
        </div>

        <div class="modal-row">
          <div class="label">Fingerprint</div>
          <div id="trust-fingerprint" class="value mono"></div>
        </div>

        <div class="modal-warn">
          Only trust this host key if you expected this server. If the key
          changed unexpectedly, it could indicate an attack.
        </div>
      </div>

      <div class="modal-actions">
        <button id="trust-cancel" class="btn secondary" title="Cancel connection">
          Cancel
        </button>
        <button id="trust-accept" class="btn primary" title="Trust host key and continue">
          Trust
        </button>
      </div>
    </div>
  </div>

  <!-- Script editor modal -->
  <div id="script-modal" class="modal hidden" role="dialog" aria-modal="true" aria-labelledby="script-title">
    <div class="modal-card">
      <div class="modal-title" id="script-title">Script</div>

      <div class="modal-body">
        <div class="form-group">
          <label>Name *</label>
          <input id="script-name" type="text" required />
        </div>
        <div class="form-group">
          <label>Command *</label>
          <textarea id="script-command" rows="3" required></textarea>
        </div>
        <div class="form-group">
          <label>Description</label>
          <textarea id="script-description" rows="2"></textarea>
        </div>
        <div class="form-group">
          <label>Scope</label>
          <select id="script-scope">
            <option value="private">Private</option>
            <option value="team">Team</option>
          </select>
        </div>
        <div class="form-group" id="script-team-row">
          <label>Team</label>
          <select id="script-team"></select>
        </div>
      </div>

      <div class="modal-actions">
        <button id="script-delete" class="btn secondary">Delete</button>
        <button id="script-cancel" class="btn secondary">Cancel</button>
        <button id="script-save" class="btn primary">Save</button>
      </div>
    </div>
  </div>

  <!-- =========================================================
     Host / Network Editor Modal
     ========================================================= -->
  <div id="editor-modal" class="modal hidden" role="dialog" aria-modal="true">
    <div class="modal-card">
      <div class="modal-title" id="editor-title">Edit</div>

      <div class="modal-body">
        <form id="editor-form">
          <!-- Network fields -->
          <div class="form-group hidden" data-scope="network">
            <label>Name *</label>
            <input id="net-name" type="text" required />
          </div>
          <div class="form-group hidden" data-scope="network">
            <label>Scope</label>
            <select id="net-scope">
              <option value="private">Private</option>
              <option value="team">Team</option>
            </select>
          </div>
          <div class="form-group hidden" data-scope="network" id="net-team-row">
            <label>Team</label>
            <select id="net-team"></select>
          </div>
          <div class="form-group hidden" data-scope="network" id="net-copy-row">
            <label>Copy to teams (admin)</label>
            <div id="net-copy-teams" class="checkbox-list"></div>
            <div class="help">Creates a copy of this network and all hosts in selected teams.</div>
          </div>

          <!-- Host fields -->
          <div class="form-group hidden" data-scope="host">
            <label>Name *</label>
            <input id="host-name" type="text" required />
          </div>
          <div class="form-group hidden" data-scope="host">
            <label>Scope</label>
            <select id="host-scope">
              <option value="private">Private</option>
              <option value="team">Team</option>
            </select>
          </div>
          <div class="form-group hidden" data-scope="host" id="host-team-row">
            <label>Team</label>
            <select id="host-team"></select>
          </div>

          <div class="form-group hidden" data-scope="host">
            <label>Host / IP *</label>
            <input id="host-host" type="text" placeholder="192.168.1.10" required />
          </div>

	          <div class="form-group hidden" data-scope="host">
	            <label>Connection *</label>
	            <select id="host-driver">
	              <option value="ssh">SSH (native)</option>
	              <option value="telecom">Telecom</option>
	            </select>
	          </div>

	          <div class="form-group hidden" data-scope="host">
	            <label>Port *</label>
	            <input id="host-port" type="number" min="1" max="65535" value="22" required />
	          </div>

          <div class="form-row two hidden" data-scope="host">
            <div class="form-group">
              <label>User *</label>
              <input id="host-user" type="text" required />
            </div>

            <div class="form-group">
              <label>Password</label>
              <input id="host-password" type="password" placeholder="Optional (stored locally)"
                autocomplete="new-password" />
            </div>
          </div>

          <div class="form-group hidden" data-scope="host">
            <label class="checkbox">
              <input id="sftp-enabled" type="checkbox" />
              Enable SFTP for this host
            </label>
            <div class="help">SFTP uses SSH. You can reuse the connection credentials or set custom ones.</div>
          </div>

          <div class="form-group hidden" id="sftp-cred-group" data-scope="host">
            <label>SFTP credentials</label>
            <select id="sftp-cred-mode">
              <option value="connection">Use connection credentials</option>
              <option value="custom">Use custom credentials</option>
            </select>
          </div>

          <div class="form-row two hidden" id="sftp-custom-row" data-scope="host">
            <div class="form-group">
              <label>SFTP user *</label>
              <input id="sftp-user" type="text" />
            </div>

            <div class="form-group">
              <label>SFTP password *</label>
              <input id="sftp-password" type="password" autocomplete="new-password" />
            </div>
          </div>

          <div class="form-group hidden" data-scope="host" data-driver="ssh">
            <label>Authentication *</label>
            <select id="host-auth">
              <option value="password">Password</option>
              <option value="key">SSH Key</option>
              <option value="agent">SSH Agent</option>
              <option value="keyboard-interactive">Keyboard Interactive</option>
            </select>
          </div>

          <div class="form-group hidden" data-scope="host" data-driver="telecom">
            <label>Protocol (-t) *</label>
            <select id="telecom-protocol">
              <option value="ssh">ssh</option>
              <option value="telnet">telnet</option>
              <option value="socket">socket</option>
              <option value="sea">sea</option>
              <option value="cmd">cmd</option>
            </select>
          </div>

          <div class="form-group hidden" data-scope="host" data-driver="telecom">
            <label>Command to run</label>
            <input id="telecom-command" type="text" placeholder="Optional: first command after connect" />
          </div>

          <div class="form-group hidden" data-scope="host" data-driver="telecom">
            <label>Telecom executable *</label>
            <div class="path-row">
              <input id="telecom-path" type="text" placeholder="/path/to/telecom/entrypoint" />
              <button id="telecom-browse" type="button" class="btn small secondary">Browse</button>
            </div>
            <input id="telecom-path-picker" type="file" class="hidden" />
          </div>
        </form>
      </div>

      <div class="modal-actions">
        <button id="editor-delete" class="btn secondary hidden"
          style="color: #ff6b7d; border-color: rgba(255, 107, 125, 0.4)">
          Delete
        </button>

        <div style="flex: 1"></div>

        <button id="editor-cancel" class="btn secondary">Cancel</button>
        <button id="editor-save" class="btn primary" disabled>Save</button>
      </div>
    </div>
  </div>

  <div id="toast-container" class="toast-container" aria-live="polite" aria-atomic="false"></div>

  <div id="confirm-modal" class="modal hidden" role="dialog" aria-modal="true" aria-labelledby="confirm-title">
    <div class="modal-card confirm-card">
      <div class="modal-title" id="confirm-title">Confirm</div>
      <div class="modal-body">
        <div id="confirm-message" class="confirm-message"></div>
      </div>
      <div class="modal-actions">
        <button id="confirm-cancel" class="btn secondary">Cancel</button>
        <button id="confirm-ok" class="btn primary">Confirm</button>
      </div>
    </div>
  </div>

  <div id="prompt-modal" class="modal hidden" role="dialog" aria-modal="true" aria-labelledby="prompt-title">
    <div class="modal-card prompt-card">
      <div class="modal-title" id="prompt-title">Input</div>
      <div class="modal-body">
        <div id="prompt-message" class="confirm-message"></div>
        <input id="prompt-input" class="prompt-input" type="text" />
      </div>
      <div class="modal-actions">
        <button id="prompt-cancel" class="btn secondary">Cancel</button>
        <button id="prompt-ok" class="btn primary">OK</button>
      </div>
    </div>
  </div>

  <script src="vendor/xterm.js"></script>
  <script src="vendor/xterm-addon-fit.js"></script>
  <script src="vendor/xterm-addon-clipboard.js"></script>
  <script src="vendor/xterm-addon-search.js"></script>
  <script src="vendor/xterm-addon-web-links.js"></script>
  <script src="app.js"></script>
</body>

</html>
